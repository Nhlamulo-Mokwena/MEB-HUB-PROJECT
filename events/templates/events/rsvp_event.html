<!DOCTYPE html>
{% load static %}
<html lang="en">
{% for message in messages %}
            <div class="alert alert-{{message.tags}} alert-dismissible fade show" role="alert">
                {{message}}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
{% endfor %}
<head>
    <meta charset="UTF-8">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>RSVP Event</title>
<script type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
</script>
<script src="{% static 'assets/events/index.js' %}"></script>
<script type="text/javascript">
   (function(){
      emailjs.init({
        publicKey: "Z_pc7v6DVMPtzbMfz",
      });
   })();
</script>
</head>
<body>
    <h1>RSVP Event</h1>
    <form action="{% url 'rsvp_event' %}?eventID={{event.event_id}}" method="POST" enctype="multipart/form-data" >
        {% csrf_token %}
        <table>
            <input type="text"  name="eventID" value="{{event.event_id}}" hidden="">
            <input type="text"  name="location" id="location" value="{{event.location}}" hidden="">
            <input type="text"  name="date" id="date" value="{{event.date}}" hidden="">
            <input type="text"  name="description" id="description" value="{{event.description}}" hidden="">
            <input type="text"  name="time" id="time" value="{{time}}" hidden>

            <tr>
                <td>Enter your name: </td>
                <td><input type="text" name="name" required id="name" ></td>
            </tr>
            <tr>
                <td>Enter your surname: </td>
                <td><input type="text" name="surname" required></td>
            </tr>
            <tr>
                <td>Enter personal email : </td>
                <td><input type="email" name="email" required id="email"></td>
                <span id="email-error" style="color: red; display: none;">Invalid email address</span>
            </tr>
            <tr>
                <td>Enter student number: </td>
                <td><input type="text" name="studentNo" required id="studNo"></td>
            </tr>
        </table>
        <button type="submit" onclick="sendMail(event)">RSVP</button>
    </form>
<script>
    const emailInput = document.getElementById('email');
const emailError = document.getElementById('email-error');

emailInput.addEventListener('input', function() {
  const email = emailInput.value;

  if (validateEmail(email)) {
    emailError.style.display = 'none';
    emailInput.style.borderColor = 'green';
  } else {
    emailError.style.display = 'inline';
    emailInput.style.borderColor = 'red';
  }
});

function validateEmail(email) {
  const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return re.test(email.toLowerCase());
}

</script>
</body>
</html>